<h2><%= l(:button_weekly_information) %></h2>
<h2><%= @beginning_of_week.to_s + ' ~ ' + (@next_week - 1).to_s %></h2>
<%= link_to(l(:title_destination_bbs), redmine_destination_bbs_path, method: :get) %>

<table class="list">
    <thead><tr>
        <th><%=h l(:field_user_name) %></th>
        <th><%=h l(:field_working_in_place) %>
        <% (@beginning_of_week...@next_week).each do |date| %>
            <th><%=h date.strftime('%m-%d') %></th>
        <% end %>
    </tr></thead>

    <tbody>
    <% @users_to_report.each do |user|%>
        <tr class="<%= cycle('odd', 'even') %>">
        <td><%= user %></td>
        <td><%= @custom_values.where(customized_id: user.id).select('value').first%></td>
        <% (@beginning_of_week...@next_week).each do |date| %>
            <% @destination_bbs_to_report.where(user_id: user.id, registration_date: date).each do |record| %>
                <td><%= record.destination %></td>
            <% end %>
        <% end %>
        </tr>
    <% end %>
    </tbody>
</table>

<%= form_with(url: {controller: 'redmine_destination_bbs', action: 'report', format: :csv}, method: :get, local: true) do |f| %>
    <%= f.submit(l(:button_csv_download)) %>
<% end %>